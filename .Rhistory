for (i in 1:t){
for (j in 1:K){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- NA
X_CPIAUCSL_change[i,j] <- NA
X_Fed_Funds[i,j] <- NA
X_SP_500_change[i,j] <- NA
else
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
for (i in 1:t){
for (j in 1:K){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- NA
X_CPIAUCSL_change[i,j] <- NA
X_Fed_Funds[i,j] <- NA
X_SP_500_change[i,j] <- NA
}
X_Unemp_Rate[i,j] <- df_drivers_monthly$Unemp_Rate[3*i-j]
X_CPIAUCSL_change[i,j] <- df_drivers_monthly$CPIAUCSL_change[3*i-j]
X_Fed_Funds[i,j] <- df_drivers_monthly$Fed_Funds[3*i-j]
X_SP_500_change[i,j] <- df_drivers$SP_500_change[3*i-j]
}
}
View(X_SP_500_change)
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
for (i in 1:t){
for (j in 1:K+1){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- NA
X_CPIAUCSL_change[i,j] <- NA
X_Fed_Funds[i,j] <- NA
X_SP_500_change[i,j] <- NA
}
X_Unemp_Rate[i,j] <- df_drivers_monthly$Unemp_Rate[3*i-j]
X_CPIAUCSL_change[i,j] <- df_drivers_monthly$CPIAUCSL_change[3*i-j]
X_Fed_Funds[i,j] <- df_drivers_monthly$Fed_Funds[3*i-j]
X_SP_500_change[i,j] <- df_drivers$SP_500_change[3*i-j]
}
}
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
for (i in 1:t){
for (j in 1:3){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- NA
X_CPIAUCSL_change[i,j] <- NA
X_Fed_Funds[i,j] <- NA
X_SP_500_change[i,j] <- NA
}
X_Unemp_Rate[i,j] <- df_drivers_monthly$Unemp_Rate[3*i-j]
X_CPIAUCSL_change[i,j] <- df_drivers_monthly$CPIAUCSL_change[3*i-j]
X_Fed_Funds[i,j] <- df_drivers_monthly$Fed_Funds[3*i-j]
X_SP_500_change[i,j] <- df_drivers$SP_500_change[3*i-j]
}
}
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
for (i in 1:t){
for (j in 1:3){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- NA
X_CPIAUCSL_change[i,j] <- NA
X_Fed_Funds[i,j] <- NA
X_SP_500_change[i,j] <- NA
else if (3*i-j>t)
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
for (i in 1:t){
for (j in 1:3){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- NA
X_CPIAUCSL_change[i,j] <- NA
X_Fed_Funds[i,j] <- NA
X_SP_500_change[i,j] <- NA
}
else if (3*i-j>t) {
X_Unemp_Rate[i,j] <- NA
X_CPIAUCSL_change[i,j] <- NA
X_Fed_Funds[i,j] <- NA
X_SP_500_change[i,j] <- NA
}
else {
X_Unemp_Rate[i,j] <- df_drivers_monthly$Unemp_Rate[3*i-j]
X_CPIAUCSL_change[i,j] <- df_drivers_monthly$CPIAUCSL_change[3*i-j]
X_Fed_Funds[i,j] <- df_drivers_monthly$Fed_Funds[3*i-j]
X_SP_500_change[i,j] <- df_drivers$SP_500_change[3*i-j]
}
}
}
View(X_Unemp_Rate)
View(X_SP_500_change)
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
for (i in 1:t){
for (j in 1:3){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- NA
X_CPIAUCSL_change[i,j] <- NA
X_Fed_Funds[i,j] <- NA
X_SP_500_change[i,j] <- NA
}
else if (3*i-j>T) {
X_Unemp_Rate[i,j] <- NA
X_CPIAUCSL_change[i,j] <- NA
X_Fed_Funds[i,j] <- NA
X_SP_500_change[i,j] <- NA
}
else {
X_Unemp_Rate[i,j] <- df_drivers_monthly$Unemp_Rate[3*i-j]
X_CPIAUCSL_change[i,j] <- df_drivers_monthly$CPIAUCSL_change[3*i-j]
X_Fed_Funds[i,j] <- df_drivers_monthly$Fed_Funds[3*i-j]
X_SP_500_change[i,j] <- df_drivers$SP_500_change[3*i-j]
}
}
}
View(X_Unemp_Rate)
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
for (i in 1:t){
for (j in 1:3){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else if (3*i-j>T) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else {
X_Unemp_Rate[i,j] <- df_drivers_monthly$Unemp_Rate[3*i-j]
X_CPIAUCSL_change[i,j] <- df_drivers_monthly$CPIAUCSL_change[3*i-j]
X_Fed_Funds[i,j] <- df_drivers_monthly$Fed_Funds[3*i-j]
X_SP_500_change[i,j] <- df_drivers$SP_500_change[3*i-j]
}
}
}
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
autoreg_y <- data.frame()
for (i in 1:t){
for (j in 1:3){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else if (3*i-j>T) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else {
X_Unemp_Rate[i,j] <- df_drivers_monthly$Unemp_Rate[3*i-j]
X_CPIAUCSL_change[i,j] <- df_drivers_monthly$CPIAUCSL_change[3*i-j]
X_Fed_Funds[i,j] <- df_drivers_monthly$Fed_Funds[3*i-j]
X_SP_500_change[i,j] <- df_drivers$SP_500_change[3*i-j]
}
if (i-1 < 1) {
autoreg_y[i] <- 0
}
else {
autoreg_y[i] <- df_price_quarterly[i-1]
}
}
}
View(df_price_quarterly)
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
autoreg_y <- data.frame()
for (i in 1:t){
for (j in 1:3){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else if (3*i-j>T) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else {
X_Unemp_Rate[i,j] <- df_drivers_monthly$Unemp_Rate[3*i-j]
X_CPIAUCSL_change[i,j] <- df_drivers_monthly$CPIAUCSL_change[3*i-j]
X_Fed_Funds[i,j] <- df_drivers_monthly$Fed_Funds[3*i-j]
X_SP_500_change[i,j] <- df_drivers$SP_500_change[3*i-j]
}
if (i-1 < 1) {
autoreg_y[i] <- 0
}
else {
autoreg_y[i] <- df_price_quarterly$change[i-1]
}
}
}
View(df_price_quarterly)
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
autoreg_y <- data.frame()
for (i in 1:t){
for (j in 1:3){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else if (3*i-j>T) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else {
X_Unemp_Rate[i,j] <- df_drivers_monthly$Unemp_Rate[3*i-j]
X_CPIAUCSL_change[i,j] <- df_drivers_monthly$CPIAUCSL_change[3*i-j]
X_Fed_Funds[i,j] <- df_drivers_monthly$Fed_Funds[3*i-j]
X_SP_500_change[i,j] <- df_drivers$SP_500_change[3*i-j]
}
if (i-1 < 1) {
autoreg_y[i] <- 0
}
else {
autoreg_y[i,1] <- df_price_quarterly$change[i-1]
}
}
}
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
autoreg_y <- data.frame()
for (i in 1:t){
for (j in 1:3){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else if (3*i-j>T) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else {
X_Unemp_Rate[i,j] <- df_drivers_monthly$Unemp_Rate[3*i-j]
X_CPIAUCSL_change[i,j] <- df_drivers_monthly$CPIAUCSL_change[3*i-j]
X_Fed_Funds[i,j] <- df_drivers_monthly$Fed_Funds[3*i-j]
X_SP_500_change[i,j] <- df_drivers$SP_500_change[3*i-j]
}
if (i-1 < 1) {
autoreg_y[i,1] <- 0
}
else {
autoreg_y[i,1] <- df_price_quarterly$change[i-1]
}
}
}
View(autoreg_y)
regressor_X <- cbind(autoreg_y,X_Unemp_Rate,X_CPIAUCSL_change,X_Fed_Funds,X_SP_500_change,autoreg_y)
remove(model_midas)
model_midas <- lm(df_price_quarterly$change ~ regressor_x)
model_midas <- lm(df_price_quarterly$change ~ regressor_X)
View(regressor_X)
regressor_X <- unlist(cbind(autoreg_y,X_Unemp_Rate,X_CPIAUCSL_change,X_Fed_Funds,X_SP_500_change,autoreg_y))
model_midas <- lm(df_price_quarterly$change ~ regressor_X)
regressor_X <- cbind(autoreg_y,X_Unemp_Rate,X_CPIAUCSL_change,X_Fed_Funds,X_SP_500_change,autoreg_y)
model_midas <- lm(df_price_quarterly$change ~ regressor_X)
regressor_X <- data.frame(autoreg_y,X_Unemp_Rate,X_CPIAUCSL_change,X_Fed_Funds,X_SP_500_change,autoreg_y)
View(regressor_X)
model_midas <- lm(df_price_quarterly$change ~ regressor_X)
fit_Y <- df_price_quarterly$change
model_midas <- lm(fit_Y ~ regressor_X)
regressor_X <- as.matrix(regressor_X)
model_midas <- lm(fit_Y ~ regressor_X)
View(model_midas)
predictions <- predict(model_midas)
plot(model_midas$fitted.values)
plot(model_midas$fitted.values, type="l")
View(df_drivers)
View(df_drivers)
View(combined_df)
View(combined_df_monthly)
View(df_drivers)
ggplot(df,aes(x=df_drivers$`df_price_quarterly$quarter`)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
geom_line(aes(y=model_midas$fitted.values), color="red")
library(ggplot2)
ggplot(df,aes(x=df_drivers$`df_price_quarterly$quarter`)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
geom_line(aes(y=model_midas$fitted.values), color="red")
View(regressor_X)
summary(model_midas)
View(regressor_X)
View(autoreg_y)
fit_Y <- as.matrix(df_price_quarterly$change)
model_midas <- lm(fit_Y ~ regressor_X)
predictions <- predict(model_midas)
ggplot(df,aes(x=df_drivers$`df_price_quarterly$quarter`)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
geom_line(aes(y=model_midas$fitted.values), color="red")
labs(x = 'Date', y = NULL)
summary(model_midas)
model_midas <- lm.fit(fit_Y, regressor_X)
View(fit_Y)
View(regressor_X)
View(X_Fed_Funds)
View(X_SP_500_change)
View(df_drivers_monthly)
X_Unemp_Rate <- data.frame()
X_CPIAUCSL_change <- data.frame()
X_Fed_Funds <- data.frame()
X_SP_500_change <- data.frame()
autoreg_y <- data.frame()
for (i in 1:t){
for (j in 1:3){
if (3*i-j <1) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else if (3*i-j>T) {
X_Unemp_Rate[i,j] <- 0
X_CPIAUCSL_change[i,j] <- 0
X_Fed_Funds[i,j] <- 0
X_SP_500_change[i,j] <- 0
}
else {
X_Unemp_Rate[i,j] <- df_drivers_monthly$Unemp_Rate[3*i-j]
X_CPIAUCSL_change[i,j] <- df_drivers_monthly$CPIAUCSL_change[3*i-j]
X_Fed_Funds[i,j] <- df_drivers_monthly$Fed_Funds[3*i-j]
X_SP_500_change[i,j] <- df_drivers_monthly$SP_500_change[3*i-j]
}
if (i-1 < 1) {
autoreg_y[i,1] <- 0
}
else {
autoreg_y[i,1] <- df_price_quarterly$change[i-1]
}
}
}
regressor_X <- data.frame(autoreg_y,X_Unemp_Rate,X_CPIAUCSL_change,X_Fed_Funds,X_SP_500_change,autoreg_y)
regressor_X <- as.matrix(regressor_X)
fit_Y <- as.matrix(df_price_quarterly$change)
model_midas <- lm(fit_Y~regressor_X)
ggplot(df,aes(x=df_drivers$`df_price_quarterly$quarter`)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
geom_line(aes(y=model_midas$fitted.values), color="red")
summary(model_midas)
X_Unemp_Rate[is.na(X_Unemp_Rate)] <- 0
X_CPIAUCSL_change[is.na(X_CPIAUCSL_change)] <- 0
X_Fed_Funds[is.na(X_Fed_Funds)] <- 0
X_SP_500_change[is.na(X_SP_500_change)] <- 0
regressor_X <- data.frame(autoreg_y,X_Unemp_Rate,X_CPIAUCSL_change,X_Fed_Funds,X_SP_500_change,autoreg_y)
regressor_X <- as.matrix(regressor_X)
fit_Y <- as.matrix(df_price_quarterly$change)
model_midas <- lm(fit_Y~regressor_X)
ggplot(df,aes(x=df_drivers$`df_price_quarterly$quarter`)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
geom_line(aes(y=model_midas$fitted.values), color="red")
View(df_drivers)
View(df_price_quarterly)
ggplot(df,aes(x=df_price_quarterly$quarter)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
geom_line(aes(y=model_midas$fitted.values), color="red")
length(df_price_quarterly$quarter)
length(df_price_quarterly$change)
length(model_midas$fitted.values)
ggplot(df,aes(x=df_price_quarterly$quarter)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
geom_line(aes(y=model_midas$fitted.values), color="red")
ggplot() +
geom_line(data = df_price_quarterly, aes(x = quarter, y = change), color = "blue") +
geom_line(data = df_price_quarterly, aes(x = quarter, y = model_midas$fitted.values), color = "red")
ggplot(df,aes(x=df_price_quarterly$quarter)) +
#geom_line(aes(y=df_price_quarterly$change), color="blue") +
geom_line(aes(y=model_midas$fitted.values), color="red")
ggplot(df,aes(x=df_price_quarterly$quarter)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
#geom_line(aes(y=model_midas$fitted.values), color="red")
labs(x = 'Date', y = NULL)
ggplot(df,aes(x=df_price_quarterly$quarter)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
geom_line(aes(y=model_midas$fitted.values), color="red")
ggplot(df_price_quarterly,aes(x=df_price_quarterly$quarter)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
geom_line(aes(y=model_midas$fitted.values), color="red")
ggplot(df_price_quarterly,aes(x=df_price_quarterly$quarter)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
#geom_line(aes(y=model_midas$fitted.values), color="red")
labs(x = 'Date', y = NULL)
ggplot(df_price_quarterly,aes(x=df_price_quarterly$quarter)) +
#geom_line(aes(y=df_price_quarterly$change), color="blue") +
#geom_line(aes(y=model_midas$fitted.values), color="red")
labs(x = 'Date', y = NULL)
ggplot(df_price_quarterly,aes(x=df_price_quarterly$quarter)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
#geom_line(aes(y=model_midas$fitted.values), color="red")
labs(x = 'Date', y = NULL)
plot(df_price_quarterly$quarter, df_price_quarterly$change, type = "l", col = "blue")
ggplot(df_price_quarterly,aes(x=df_price_quarterly$quarter)) +
geom_line(aes(y=df_price_quarterly$change), color="blue") +
geom_line(aes(y=model_midas$fitted.values), color="red")
df_price_quarterly
model_midas
model_midas$fitted.values
df_temp <- data.frame(df_price_quarterly$quarter,df_price_quarterly$change,model_midas$fitted.values)
View(df_temp)
ggplot(df_temp,aes(x=df_temp$df_price_quarterly.quarter)) +
geom_line(aes(y=df_temp$df_price_quarterly.change), color="blue") +
geom_line(aes(y=df_temp$model_midas.fitted.values), color="red")
ggplot(df_temp,aes(x=df_temp$df_price_quarterly.quarter)) +
geom_line(y=df_temp$df_price_quarterly.change, color="blue") +
geom_line(y=df_temp$model_midas.fitted.values, color="red")
df_temp$df_price_quarterly.change
cbind(df_price_quarterly$quarter,df_price_quarterly$change,model_midas$fitted.values)
colnames(df_temp)
df_temp <- data.frame(df_price_quarterly$quarter,df_price_quarterly$change,model_midas$fitted.values)
colnames(df_temp) <- c("quarter","change","fitted_values")
View(df_temp)
df_temp_melted <- melt(df_temp, id.vars = "quarter")
conflict_prefer('melt', 'reshape2')
library(dplyr)
library(stringr)
library(data.table)
library(ggplot2)
library(mondate)
library(zoo)
library(VGAM)
library(MASS)
library(car)
library(forecast)
library(conflicted)
library(tidyr)
library(scales)
library(reshape2)
library(psych)
library(vars)
library(lmtest)
conflict_prefer('select', 'dplyr')
conflict_prefer('filter', 'dplyr')
conflict_prefer('lag', 'dplyr')
conflict_prefer('melt', 'reshape2')
df_temp_melted <- melt(df_temp, id.vars = "quarter")
View(df_temp_melted)
View(df_temp_melted)
ggplot(df_temp_melted,aes(x=quarter)) +
geom_line(aes(y=value), color=varÄ±able) +
labs(x = 'Date', y = NULL)
ggplot(df_temp_melted,aes(x=quarter)) +
geom_line(aes(y=value), color=variable) +
labs(x = 'Date', y = NULL)
ggplot(df_temp_melted,aes(x=quarter)) +
geom_line(aes(y=value, color=variable)) +
labs(x = 'Date', y = NULL)
str(df_temp_melted)
ggplot(df_temp_melted,aes(x=quarter)) +
geom_line(aes(y=value, color=variable)) +
labs(x = 'Date', y = NULL)
View(df_temp)
ggplot(df_temp_melted,aes(x=quarter)) +
geom_line(aes(y=value, color="blue")) +
geom_line(aes(fitted_values),color="red")
ggplot(df_temp_melted,aes(x=quarter)) +
geom_line(aes(y=value, color="blue")) +
geom_line(aes(y=fitted_values),color="red")
View(df_temp)
ggplot(df_temp,aes(x=quarter)) +
geom_line(aes(y=value, color="blue")) +
geom_line(aes(y=fitted_values),color="red")
ggplot(df_temp,aes(x=quarter)) +
geom_line(aes(y=change, color="blue")) +
geom_line(aes(y=fitted_values),color="red")
ggplot(df_temp,aes(x=quarter)) +
geom_line(aes(y=change, color="blue")) +
geom_line(aes(y=fitted_values,color="red"))
plot(df_temp$change, typle="l")
plot(df_temp$fitted_values,type="l")
plot(df_temp$change, typle="l")
